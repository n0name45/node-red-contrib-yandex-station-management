[
    {
        "id": "db7d25d3.9110a8",
        "type": "ui_template",
        "z": "0c069b6a05278757",
        "group": "8865f91.bf77188",
        "name": "",
        "order": 1,
        "width": "8",
        "height": "8",
        "format": "<style>\n  .yandex-player {\n    height: 100%;\n    position: relative;\n    min-height: 128px;\n    z-index: 1;\n    background: url(\"//avatars.mds.yandex.net/get-music-misc/29541/img.5e6a1c5b38be6e3bae26558a/600x600\");\n    background-repeat: no-repeat;\n    background-position: center;\n    background-size: cover;\n  }\n\n  .yandex-player .gradient {\n    background: linear-gradient(rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75));\n    position: absolute;\n    bottom: 0;\n    left: 0;\n  }\n\n  .yandex-player .controls {\n    margin: 24px 32px;\n    color: rgba(255, 255, 255, 0.75);\n    font-family: Roboto, Noto, sans-serif;\n    -moz-osx-font-smoothing: grayscale;\n    -webkit-font-smoothing: antialiased;\n    font-weight: lighter;\n  }\n\n  .yandex-player .title {\n    font-size: larger;\n  }\n\n  .yandex-player .subtitle {\n    font-size: medium;\n  }\n\n  .yandex-player .ui {\n    padding: 16px 0 24px 0;\n  }\n\n  .yandex-player .ui i {\n    cursor: pointer;\n  }\n\n  .yandex-player .ui i:hover {\n    color: rgba(255, 255, 255, 1);\n  }\n\n  .yandex-player .ui-btn {\n    float: left;\n    display: flex;\n    justify-content: space-between;\n    width: 20%;\n  }\n\n  .yandex-player .ui-volume {\n    float: right;\n    display: flex;\n    justify-content: space-between;\n    width: 80%;\n    vertical-align: middle;\n  }\n\n  .yandex-player .slider {\n    position: relative;\n    cursor: pointer;\n    width: 100%;\n    margin: 0 16px;\n    opacity: 1;\n    display: inline-block;\n  }\n\n  .yandex-player .slider_base {\n    width: 100%;\n    height: 2px;\n    background-color: rgba(255, 255, 255, 0.75);\n    border-radius: 2px;\n    position: absolute;\n    top: 8px;\n  }\n\n  .yandex-player .slider_progress {\n    height: 4px;\n    background-color: rgba(255, 255, 255, 1);\n    border-radius: 2px;\n    position: absolute;\n    top: 7px;\n  }\n\n  .yandex-player .bar {\n    position: absolute;\n    cursor: pointer;\n    width: 100%;\n    opacity: 1;\n    bottom: 0;\n    height: 6px;\n    background-color: rgba(255, 255, 255, 0.75);\n  }\n\n  .yandex-player .bar_progress {\n    width: 0;\n    height: 100%;\n    background-color: #fc0;\n  }\n\n  .yandex-player .red {\n    color: red;\n  }\n</style>\n<div class=\"yandex-player\">\n  <div class=\"gradient\" style=\"min-height: 128px; width: 100%;\">\n    <div class=\"controls\">\n      <div class=\"title\"></div>\n      <div class=\"subtitle\"></div>\n      <div class=\"ui\">\n        <div class=\"ui-btn\">\n          <i class=\"fa fa-step-backward fa-lg\" aria-hidden=\"true\"></i>\n          <i class=\"btn-play-pause fa fa-play fa-lg\" aria-hidden=\"true\"></i>\n          <i class=\"fa fa-step-forward fa-lg\" aria-hidden=\"true\"></i>\n        </div>\n\n        <div class=\"ui-volume\">\n          <div class=\"slider\">\n            <div class=\"slider_base\"></div>\n            <div class=\"slider_progress\"></div>\n          </div>\n          <div style=\"width: 10%;\">\n            <i class=\"btn-volume fa fa-volume-up fa-lg\" aria-hidden=\"true\"></i>\n          </div>\n          <div style=\"width: 10%; text-align: right; margin-left: 16px;\">\n            <i class=\"fa fa-heart fa-lg\" aria-hidden=\"true\"></i>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class=\"bar\">\n      <div class=\"bar_progress\"></div>\n    </div>\n  </div>\n</div>\n<script>\n  /*! js-cookie v3.0.0-rc.1 | MIT */\n  !function (e, t) { \"object\" == typeof exports && \"undefined\" != typeof module ? module.exports = t() : \"function\" == typeof define && define.amd ? define(t) : (e = e || self, function () { var n = e.Cookies, r = e.Cookies = t(); r.noConflict = function () { return e.Cookies = n, r } }()) }(this, function () { \"use strict\"; function e(e) { for (var t = 1; t < arguments.length; t++) { var n = arguments[t]; for (var r in n) e[r] = n[r] } return e } var t = { read: function (e) { return e.replace(/(%[\\dA-F]{2})+/gi, decodeURIComponent) }, write: function (e) { return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g, decodeURIComponent) } }; return function n(r, o) { function i(t, n, i) { if (\"undefined\" != typeof document) { \"number\" == typeof (i = e({}, o, i)).expires && (i.expires = new Date(Date.now() + 864e5 * i.expires)), i.expires && (i.expires = i.expires.toUTCString()), t = encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g, decodeURIComponent).replace(/[()]/g, escape), n = r.write(n, t); var c = \"\"; for (var u in i) i[u] && (c += \"; \" + u, !0 !== i[u] && (c += \"=\" + i[u].split(\";\")[0])); return document.cookie = t + \"=\" + n + c } } return Object.create({ set: i, get: function (e) { if (\"undefined\" != typeof document && (!arguments.length || e)) { for (var n = document.cookie ? document.cookie.split(\"; \") : [], o = {}, i = 0; i < n.length; i++) { var c = n[i].split(\"=\"), u = c.slice(1).join(\"=\"); '\"' === u[0] && (u = u.slice(1, -1)); try { var f = t.read(c[0]); if (o[f] = r.read(u, f), e === f) break } catch (e) { } } return e ? o[e] : o } }, remove: function (t, n) { i(t, \"\", e({}, n, { expires: -1 })) }, withAttributes: function (t) { return n(this.converter, e({}, this.attributes, t)) }, withConverter: function (t) { return n(e({}, this.converter, t), this.attributes) } }, { attributes: { value: Object.freeze(o) }, converter: { value: Object.freeze(r) } }) }(t, { path: \"/\" }) });\n</script>\n<script>\n  (function (scope) {\n    // function\n   function setVolume(volume) {\n      //console.log('setVolume:' + volume);\n\n      if (volume <= 4.5) {\n        volume = 0;\n      } else if (volume > 4.5 && volume < 10) {\n        volume = 10;\n      } else if (volume >= 95.5) {\n        volume = 100;\n      }\n\n      let toggle = volume > 0 ? true : false;\n      $('.btn-volume').toggleClass('fa-volume-up', toggle).toggleClass('fa-volume-off', !toggle);\n\n      scope.send({ 'payload': { 'command': 'setVolume', 'volume': volume / 100 } });\n    }\n\n    function setProgress(playerState) {\n      let progress = (playerState.progress / playerState.duration) * 100;\n      //$('.bar_progress').animate({ width: progress + '%' }, 'fast');\n      $('.bar_progress').width(progress + '%');\n    }\n\n    function setLike(id) {\n      let like = JSON.parse(Cookies.get('yandex-like') || '{}');\n      like[id] = id;\n      Cookies.set('yandex-like', JSON.stringify(like), { expires: 3 });\n      $('.fa-heart').addClass('red');\n\n      scope.send({ payload: { 'command': 'sendText', 'text': 'поставь лайк' } });\n    }\n\n    function setDislike(id) {\n      let like = JSON.parse(Cookies.get('yandex-like') || '{}');\n      if (like[id] !== undefined) {\n        delete like[id];\n      }\n      Cookies.set('yandex-like', JSON.stringify(like), { expires: 3 });\n      $('.fa-heart').removeClass('red');\n\n      scope.send({ payload: { 'command': 'sendText', 'text': 'поставь дизлайк' } });\n    }\n\n    // init+update\n    scope.$watch('msg', function (msg) {\n      if (msg) {\n\n        if ('volume' in msg.payload) {\n          $('.slider_progress').animate({width: msg.payload.volume * 100 + '%'}, 150);\n        }\n\n        if (msg.payload.playing === true || msg.payload.playing === false) {\n          $('.btn-play-pause').toggleClass('fa-pause', msg.payload.playing).toggleClass('fa-play', !msg.payload.playing);\n        }\n\n        if ('playerState' in msg.payload) {\n          //update title\n          $('.title').text(msg.payload.playerState.title);\n          $('.subtitle').text(msg.payload.playerState.subtitle);\n\n          //update img\n          let thumb = 'avatars.mds.yandex.net/get-music-misc/29541/img.5e6a1c5b38be6e3bae26558a/%%';\n          if (msg.payload.playerState.extra !== null && typeof msg.payload.playerState.extra.coverURI !== \"undefined\") {\n            thumb = msg.payload.playerState.extra.coverURI;\n          }\n          thumb = '//' + thumb.replace(/%%/g, \"600x600\");\n\n          if (thumb != $('.yandex-player').attr('data-image')) {\n            $('.yandex-player').css('background-image', 'url(' + thumb + ')').attr('data-image', thumb);\n          }\n\n          setProgress(msg.payload.playerState);\n\n          let id = msg.payload.playerState.id;\n          if (id != $('.fa-heart').attr('data-id')) {\n            $('.fa-heart').removeClass('red').attr('data-id', id);\n            let like = JSON.parse(Cookies.get('yandex-like') || '{}');\n            if (like[id]) {\n              $('.fa-heart').addClass('red');\n            }\n          }\n        }\n      }\n    });\n\n    // controls\n    $('.btn-play-pause').click(function () {\n      scope.send({ 'payload': { 'command': scope.msg.payload.playing ? 'stop' : 'play' } });\n    });\n\n    $('.fa-step-backward').click(function () {\n      scope.send({ 'payload': { 'command': 'prev' } });\n    });\n\n    $('.fa-step-forward').click(function () {\n      scope.send({ 'payload': { 'command': 'next' } });\n    });\n\n    // slider volume\n    $('.slider').on('click', function (event) {\n      let left = $('.slider').offset().left;\n      let width = $('.slider').outerWidth();\n\n      let volume = (event.clientX - left) / width * 100;\n\n      setVolume(volume);\n    });\n\n    // volume\n    $('.btn-volume').on('click', function () {\n      if ($(this).hasClass('fa-volume-up')) {\n        Cookies.set('yandex-volume-save', $('.slider_progress').width(), { expires: 7 });\n        setVolume(0);\n      } else if ($(this).hasClass('fa-volume-off')) {\n        setVolume(Cookies.get('yandex-volume-save'));\n      }\n    });\n\n    // bar\n    $('.bar').on('click', function (event) {\n      let left = $('.bar').offset().left;\n      let width = $('.bar').outerWidth();\n\n      let percent = (event.clientX - left) / width * 100;\n      let position = Math.round(percent * (scope.msg.payload.playerState.duration / 100));\n\n      scope.send({ 'payload': { 'command': 'rewind', 'position': position } });\n      if ($('.btn-play-pause').hasClass('fa-play')) {\n        scope.send({ 'payload': { 'command': 'play' } });\n      }\n    });\n\n    //like\n    $('.fa-heart').on('click', function () {\n      let id = $(this).attr('data-id');\n      if (!$(this).hasClass('red')) {\n        setLike(id);\n      } else {\n        setDislike(id);\n      }\n    });\n\n  })(scope);\n</script>",
        "storeOutMessages": true,
        "fwdInMessages": false,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 400,
        "y": 260,
        "wires": [
            [
                "ae2a51d2fe666ff9"
            ]
        ]
    },
    {
        "id": "8865f91.bf77188",
        "type": "ui_group",
        "name": "Alice",
        "tab": "bd17abae.b2461",
        "order": 1,
        "disp": true,
        "width": "8",
        "collapse": false,
        "className": ""
    },
    {
        "id": "bd17abae.b2461",
        "type": "ui_tab",
        "name": "Кубик³",
        "icon": "dashboard",
        "order": 1,
        "disabled": false,
        "hidden": false
    }
]